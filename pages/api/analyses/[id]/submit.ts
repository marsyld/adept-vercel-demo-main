import type { NextApiRequest, NextApiResponse } from 'next'; let store:any = (global as any)._BYUTICH_STORE || ((global as any)._BYUTICH_STORE = { rows: [] }); export default function handler(req:NextApiRequest,res:NextApiResponse){ if(!req.headers.authorization) return res.status(401).json({error:'unauthorized'}); const id=req.query.id as string; const row=store.rows.find((r:any)=>r.id===id); if(!row) return res.status(404).json({error:'not_found'}); row.status='done'; row.assets={ normalized_url:'/demo/before.jpg', after_simulation_url:'/demo/after.jpg' }; return res.status(202).json({ id, status:'pending' }); }